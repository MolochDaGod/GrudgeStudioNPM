import"./modulepreload-polyfill-B5Qt9EMX.js";import{g as y,b as v}from"./StatsUtils-Dj8vluZS.js";const m={Strength:{color:"#ef4444",description:"Physical power",fullDescription:"Increases physical damage, carry capacity, and melee effectiveness.",statContributions:{damage:2,carryWeight:5,meleePower:1.5}},Dexterity:{color:"#22c55e",description:"Agility and precision",fullDescription:"Improves attack speed, evasion, and ranged accuracy.",statContributions:{attackSpeed:.02,evasion:.3,accuracy:1.5}},Constitution:{color:"#f97316",description:"Health and resilience",fullDescription:"Boosts maximum health, stamina, and resistance to status effects.",statContributions:{health:10,stamina:5,statusResist:.2}},Intelligence:{color:"#3b82f6",description:"Magical aptitude",fullDescription:"Enhances mana pool, spell damage, and cooldown reduction.",statContributions:{mana:8,spellDamage:1.8,cooldownReduction:.15}},Wisdom:{color:"#a855f7",description:"Mental fortitude",fullDescription:"Improves mana regeneration, experience gain, and magic resistance.",statContributions:{manaRegen:.5,expBonus:.1,magicResist:.25}},Charisma:{color:"#ec4899",description:"Social influence",fullDescription:"Affects NPC relations, shop prices, and companion effectiveness.",statContributions:{shopDiscount:.2,companionBonus:.5,persuasion:1}},Luck:{color:"#eab308",description:"Fortune and chance",fullDescription:"Increases critical hit chance, loot quality, and dodge chance.",statContributions:{criticalChance:.25,lootBonus:.3,dodgeChance:.1}},Willpower:{color:"#06b6d4",description:"Mental strength",fullDescription:"Boosts defense, crowd control resistance, and focus duration.",statContributions:{defense:1.5,ccResist:.3,focusDuration:.5}}},E={health:"Maximum health points",mana:"Maximum mana for abilities",stamina:"Maximum stamina for actions",damage:"Base physical damage",defense:"Damage reduction",evasion:"Chance to dodge attacks",criticalChance:"Chance for critical hits",attackSpeed:"Speed multiplier for attacks",spellDamage:"Bonus magical damage",manaRegen:"Mana regeneration per second"},B=new Set(["evasion","criticalChance","attackSpeed","cooldownReduction","statusResist","magicResist","expBonus","shopDiscount","lootBonus","dodgeChance","ccResist"]),u=160;class S{constructor(){this.attributes={},Object.keys(m).forEach(e=>{this.attributes[e]=0})}setAttribute(e,i){m[e]!==void 0&&(this.attributes[e]=Math.max(0,Math.min(u,i)))}getAttribute(e){return this.attributes[e]||0}getEffectiveAttribute(e){return y(this.getAttribute(e))}getAttributeBreakdown(e){return v(this.getAttribute(e))}getTotalSpent(){return Object.values(this.attributes).reduce((e,i)=>e+i,0)}getRemainingPoints(){return u-this.getTotalSpent()}calculateStats(){const e={health:100,mana:50,stamina:100,damage:10,defense:5,evasion:0,criticalChance:5,attackSpeed:1,spellDamage:0,manaRegen:1,carryWeight:50,meleePower:0,accuracy:50,statusResist:0,cooldownReduction:0,expBonus:0,magicResist:0,shopDiscount:0,companionBonus:0,persuasion:0,lootBonus:0,dodgeChance:0,ccResist:0,focusDuration:0};return Object.entries(this.attributes).forEach(([i,a])=>{if(a===0)return;const n=y(a),s=m[i];s?.statContributions&&Object.entries(s.statContributions).forEach(([r,o])=>{e[r]!==void 0&&(e[r]+=n*o)})}),e}reset(){Object.keys(this.attributes).forEach(e=>{this.attributes[e]=0})}randomize(){this.reset();let e=u;const i=Object.keys(this.attributes);for(;e>0;){const a=i[Math.floor(Math.random()*i.length)],n=Math.min(e,Math.floor(Math.random()*10)+1);this.attributes[a]+=n,e-=n}}toBase64(){return btoa(Object.values(this.attributes).join(","))}fromBase64(e){try{const i=atob(e).split(",").map(Number);Object.keys(this.attributes).forEach((a,n)=>{this.attributes[a]=i[n]||0})}catch(i){console.error("Failed to decode build:",i)}}}class w{constructor(e){this.attributeSystem=e,this.archetypes=[{name:"Berserker",tier:"Mythic",className:"mythic",description:"A fearsome warrior who channels rage into devastating attacks.",requirements:{Strength:40,Constitution:30}},{name:"Archmage",tier:"Mythic",className:"mythic",description:"Master of the arcane arts with unrivaled magical power.",requirements:{Intelligence:40,Wisdom:30}},{name:"Shadow Dancer",tier:"Mythic",className:"mythic",description:"A deadly assassin who strikes from the shadows.",requirements:{Dexterity:40,Luck:25}},{name:"Paladin",tier:"Legendary",className:"legendary",description:"Holy warrior blessed with divine protection.",requirements:{Strength:30,Willpower:30,Charisma:20}},{name:"Battlemage",tier:"Legendary",className:"legendary",description:"Warrior-mage combining martial and magical prowess.",requirements:{Strength:25,Intelligence:30,Constitution:20}},{name:"Ranger",tier:"Legendary",className:"legendary",description:"Swift hunter with deadly precision.",requirements:{Dexterity:30,Wisdom:20,Luck:20}},{name:"Warrior",tier:"Epic",className:"epic",description:"Skilled fighter with balanced combat abilities.",requirements:{Strength:25,Constitution:20}},{name:"Mage",tier:"Epic",className:"epic",description:"Practitioner of the magical arts.",requirements:{Intelligence:25,Wisdom:15}},{name:"Rogue",tier:"Epic",className:"epic",description:"Cunning fighter specializing in quick strikes.",requirements:{Dexterity:25,Luck:15}},{name:"Tank",tier:"Rare",className:"rare",description:"Heavily armored defender.",requirements:{Constitution:25,Willpower:15}},{name:"Healer",tier:"Rare",className:"rare",description:"Support specialist focused on restoration.",requirements:{Wisdom:25,Charisma:15}},{name:"Fighter",tier:"Common",className:"common",description:"Basic combat training.",requirements:{Strength:15}},{name:"Apprentice",tier:"Common",className:"common",description:"Aspiring magic user.",requirements:{Intelligence:15}},{name:"Scout",tier:"Common",className:"common",description:"Quick and agile explorer.",requirements:{Dexterity:15}}]}detect(){const e=this.attributeSystem.attributes;if(this.attributeSystem.getTotalSpent()===0)return{name:"...",tier:"Unclassified",className:"unclassified",description:"Spend all 160 points to reveal your class rank."};for(const n of this.archetypes){let s=!0;for(const[r,o]of Object.entries(n.requirements))if((e[r]||0)<o){s=!1;break}if(s)return n}const a=Object.entries(e).reduce((n,[s,r])=>r>n.val?{attr:s,val:r}:n,{attr:"",val:0});return a.val>=10?{name:`${a.attr} Novice`,tier:"Novice",className:"novice",description:`Beginning to develop ${a.attr.toLowerCase()}-based skills.`}:{name:"Adventurer",tier:"Beginner",className:"beginner",description:"A fresh adventurer just starting their journey."}}}const c=new S,C=new w(c);let h=null;function x(){const t=document.getElementById("buildChart").getContext("2d"),e=Object.keys(m);h=new window.Chart(t,{type:"radar",data:{labels:e,datasets:[{label:"Attributes",data:e.map(()=>0),backgroundColor:"rgba(110, 231, 183, 0.2)",borderColor:"rgba(110, 231, 183, 1)",borderWidth:2,pointBackgroundColor:"rgba(168, 85, 247, 1)",pointBorderColor:"#fff",pointRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{r:{beginAtZero:!0,max:50,ticks:{stepSize:10,color:"#a5b4d0",backdropColor:"transparent"},grid:{color:"rgba(42, 49, 80, 0.5)"},angleLines:{color:"rgba(42, 49, 80, 0.5)"},pointLabels:{color:"#e8eaf6",font:{size:11,weight:"600"}}}},plugins:{legend:{display:!1}}}})}function k(){if(!h)return;const t=Object.keys(m);h.data.datasets[0].data=t.map(e=>c.getAttribute(e)),h.update()}function I(){const t=document.getElementById("attributesContainer");t.innerHTML="",Object.entries(m).forEach(([e,i])=>{const a=document.createElement("div");a.className="attribute-item",a.innerHTML=`
                    <div class="attribute-header">
                        <label class="attribute-label">
                            <span class="attribute-color" style="background: ${i.color}"></span>
                            ${e}
                        </label>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <span class="attribute-value" id="value-${e}">0</span>
                            <span class="effective-value" id="effective-${e}" style="font-size: 0.75rem; color: var(--muted);">(0 eff)</span>
                        </div>
                    </div>
                    <div class="attribute-controls">
                        <input type="range" id="slider-${e}" min="0" max="${u}" value="0" />
                        <input type="number" id="input-${e}" min="0" max="${u}" value="0" />
                    </div>
                    <div class="diminishing-indicator" id="diminishing-${e}" style="display: none; margin-top: 4px; font-size: 0.75rem; padding: 4px 8px; border-radius: 4px;"></div>
                `,t.appendChild(a);const n=a.querySelector(`#slider-${e}`),s=a.querySelector(`#input-${e}`),r=o=>{c.setAttribute(e,parseInt(o)||0),b()};n.addEventListener("input",o=>r(o.target.value)),s.addEventListener("change",o=>r(o.target.value))})}function A(){const t=c.calculateStats(),e=document.getElementById("statsContainer");e.innerHTML="",Object.entries(E).forEach(([i,a])=>{const n=document.createElement("div");n.className="stat-card",n.title=a;const s=B.has(i),r=s?(t[i]||0).toFixed(2):Math.floor(t[i]||0),o=i.replace(/([A-Z])/g," $1").trim();n.innerHTML=`
                    <div class="stat-label">${o}</div>
                    <div class="stat-value ${s?"percentage":""}">${r}</div>
                `,e.appendChild(n)})}function $(){const t=document.getElementById("learningPanel");t.innerHTML="",Object.entries(c.attributes).forEach(([e,i])=>{if(i===0)return;const a=m[e],n=c.getAttributeContributions(e),s=document.createElement("div");s.className="attribute-details";let r=n.map(o=>{const d=o.isPercentage?o.value.toFixed(2)+"%":o.value.toFixed(1);return`<div>â€¢ ${o.label}: +${d}</div>`}).join("");s.innerHTML=`
                    <h4>${e} <span style="color: #a5b4d0;">(${i})</span></h4>
                    <div class="description">${a.fullDescription}</div>
                    <div class="gains">${r}</div>
                `,t.appendChild(s)}),t.innerHTML===""&&(t.innerHTML='<p style="color: var(--muted);">Allocate points to see attribute details here.</p>')}function N(t){return Math.floor((t.health||0)*.5+(t.damage||0)*5+(t.defense||0)*2+(t.mana||0)*.3+(t.criticalChance||0)*20+(t.evasion||0)*15)}function L(t,e){const i=t/e;return i>=1?{rating:"S",color:"#ffd700"}:i>=.9?{rating:"A",color:"#10b981"}:i>=.7?{rating:"B",color:"#3b82f6"}:i>=.5?{rating:"C",color:"#f97316"}:i>=.25?{rating:"D",color:"#9ca3af"}:{rating:"-",color:"#4b5563"}}function R(t){const e=Object.values(t),i=Math.max(...e),a=Math.min(...e.filter(s=>s>0)||[0]),n=e.reduce((s,r)=>s+r,0);return n===0?"Allocate points to see your build analysis.":n<80?"Keep allocating points to unlock your full potential.":i>50&&a<10?"Highly specialized build. Strong in focus areas but vulnerable elsewhere.":i-a<10?"Well-balanced build. Versatile but may lack burst potential.":"Solid build. Consider specializing further for higher tiers."}function b(){const t=c.getTotalSpent(),e=c.calculateStats();Object.keys(c.attributes).forEach(d=>{const f=c.getAttribute(d),p=v(f);document.getElementById(`value-${d}`).textContent=f,document.getElementById(`slider-${d}`).value=f,document.getElementById(`input-${d}`).value=f;const g=document.getElementById(`effective-${d}`),l=document.getElementById(`diminishing-${d}`);f>0?(g.textContent=`(${p.effective.toFixed(1)} eff)`,p.category==="Hard Capped"?(g.style.color="#ef4444",l.style.display="block",l.style.background="rgba(239, 68, 68, 0.2)",l.style.color="#ef4444",l.textContent=`Hard Capped! ${p.wastedPoints} wasted points. Next point: ${p.nextPointEffectiveness}% effective`):p.category==="Diminishing"?(g.style.color="#f97316",l.style.display="block",l.style.background="rgba(249, 115, 22, 0.2)",l.style.color="#f97316",l.textContent=`Diminishing returns active. Next point: ${p.nextPointEffectiveness}% effective`):(g.style.color="var(--muted)",l.style.display="none")):(g.textContent="(0 eff)",g.style.color="var(--muted)",l.style.display="none")});const i=document.getElementById("pointsCounter");document.getElementById("pointsValue").textContent=`${t} / ${u}`,i.classList.toggle("complete",t===u);const a=C.detect(),n=document.getElementById("resultCard");document.getElementById("resultTier").textContent=a.tier,document.getElementById("resultName").textContent=a.name,document.getElementById("resultDesc").textContent=a.description,n.className=`result-card ${a.className}`;const s=N(e);document.getElementById("combatPowerValue").textContent=s.toLocaleString();const r=L(t,u),o=document.getElementById("buildRatingValue");o.textContent=r.rating,o.style.color=r.color,document.getElementById("buildAdvice").textContent=R(c.attributes),A(),$(),k()}document.getElementById("resetBtn").addEventListener("click",()=>{confirm("Reset all points?")&&(c.reset(),b())});document.getElementById("randomBtn").addEventListener("click",()=>{c.randomize(),b()});document.getElementById("shareBtn").addEventListener("click",()=>{const t=c.toBase64(),e=`${window.location.origin}${window.location.pathname}?build=${t}`;navigator.clipboard.writeText(e).then(()=>{alert("Build URL copied to clipboard!")})});document.getElementById("applyBtn").addEventListener("click",()=>{const t=c.calculateStats(),e=C.detect();localStorage.setItem("grudge_character_build",JSON.stringify({attributes:c.attributes,stats:t,classInfo:e})),alert("Build saved! Return to the game to use your character.")});function M(){const t=new URLSearchParams(window.location.search);t.has("build")&&c.fromBase64(t.get("build")),I(),x(),b()}M();window.switchMainTab=function(t){document.querySelectorAll(".main-tab").forEach(e=>e.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(e=>e.classList.remove("active")),event.target.classList.add("active"),document.getElementById(`${t}-tab`).classList.add("active")};
